---
/* eslint max-lines: 'off' */

import { asset, url } from '../lib/data.js';
import PictureUploader from '../components/PictureUploader.astro';
import ToggleSwitch from '../components/ToggleSwitch.astro';
---

<div
	class="grid grid-cols-1 px-4 pt-6 xl:grid-cols-3 xl:gap-4 dark:bg-gray-900"
>
	<div class="mb-4 col-span-full xl:mb-2">
		<nav class="flex mb-5" aria-label="Breadcrumb">
			<ol
				class="inline-flex items-center space-x-1 text-sm font-medium md:space-x-2"
			>
				<li class="inline-flex items-center">
					<a
						href="#"
						class="inline-flex items-center text-gray-700 hover:text-primary-600 dark:text-gray-300 dark:hover:text-white"
					>
						<svg
							class="w-5 h-5 mr-2.5"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							><path
								d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"
							></path></svg
						>
						Inicio
					</a>
				</li>
				<li>
					<div class="flex items-center">
						<svg
							class="w-6 h-6 text-gray-400"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							><path
								fill-rule="evenodd"
								d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
								clip-rule="evenodd"></path></svg
						>
						<a
							href="#"
							class="ml-1 text-gray-700 hover:text-primary-600 md:ml-2 dark:text-gray-300 dark:hover:text-white"
							>Projectos</a
						>
					</div>
				</li>
				<li>
					<div class="flex items-center">
						<svg
							class="w-6 h-6 text-gray-400"
							fill="currentColor"
							viewBox="0 0 20 20"
							xmlns="http://www.w3.org/2000/svg"
							><path
								fill-rule="evenodd"
								d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
								clip-rule="evenodd"></path></svg
						>
						<span
							class="ml-1 text-gray-400 md:ml-2 dark:text-gray-500"
							aria-current="page">Girl in tech</span
						>
					</div>
				</li>
			</ol>
		</nav>
		<h1 class="text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white">
		 Reporte del proyecto
		</h1>
	</div>
	<!-- Right Content -->
	<div class="col-span-full xl:col-auto">
		<div
			class="p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800"
		>
			<div
				class="items-center sm:flex xl:block 2xl:flex sm:space-x-4 xl:space-x-0 2xl:space-x-4"
			>
				<PictureUploader title="Girls in tech" />
			</div>
		</div>
		<div
			class="p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800"
		>
			<h3 class="mb-4 text-xl font-semibold dark:text-white">
				Ejes & Impacto
			</h3>
			<div class="mb-4">
				<label
					for="settings-language"
					class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
					>Eje principal</label
				>
				<select
  id="settings-language"
  name="countries"
  disabled
  aria-disabled="true"
  class="bg-gray-50 border-gray-300 text-gray-900 sm:text-sm rounded-lg block w-full p-2.5
         dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white
         disabled:opacity-60 disabled:cursor-not-allowed">
  <option selected>Educación</option>
  <option>Ambiente</option>
  <option>Nutrición</option>
  <option>Equidad de género</option>
  <option>Emprendimiento</option>
</select>
			</div>
			<div class="mb-6">
				<label
					for="settings-timezone"
					class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
					>Impacto a medir</label
				>
			<select
  id="settings-timezone"
  name="countries"
  disabled aria-disabled="true"
  class="bg-gray-50 border-gray-300 text-gray-900 sm:text-sm rounded-lg block w-full p-2.5
         dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white
         disabled:opacity-60 disabled:cursor-not-allowed">
  <option selected>Habilidades duras maestros</option>
  <option>Habilidades duras NNA</option>
  <option>Habilidades blandas padres</option>
</select>
				<div id="settings-timezone-chips" class="mt-2 flex flex-wrap gap-2" aria-live="polite"></div>
				<div id="settings-timezone-hidden" aria-hidden="true"></div>

				<script is:inline>
					(function initTimezoneChips() {
						const select = document.getElementById('settings-timezone');
						const chips = document.getElementById('settings-timezone-chips');
						const hidden = document.getElementById('settings-timezone-hidden');

						function createHidden(value) {
							const inp = document.createElement('input');
							inp.type = 'hidden';
							inp.name = 'timezones[]';
							inp.value = value;
							return inp;
						}

						function createChip(label, value, optionEl) {
							const wrapper = document.createElement('span');
							wrapper.className = 'inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-white';
							wrapper.setAttribute('role', 'group');

							const text = document.createElement('span');
							text.textContent = label;
							wrapper.appendChild(text);

							const btn = document.createElement('button');
							btn.type = 'button';
							btn.className = 'ml-2 inline-flex items-center justify-center w-5 h-5 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600';
							btn.setAttribute('aria-label', `Eliminar ${label}`);
							btn.textContent = '×';
							function makeRemoveHandler(wrapperEl, val, optEl) {
								const optLocal = optEl;
								return function handleRemove() {
									// remove hidden input(s) with same value
									const inputs = hidden.querySelectorAll('input');
									inputs.forEach(i => { if (i.value === val) i.remove(); });
									wrapperEl.remove();
									if (optLocal) optLocal.disabled = false;
								};
							}

							btn.addEventListener('click', makeRemoveHandler(wrapper, value, optionEl));

							wrapper.appendChild(btn);

							chips.appendChild(wrapper);
							hidden.appendChild(createHidden(value));
						}

						if (!select) return;

						function handleSelectChange() {
							const idx = select.selectedIndex;
							if (idx < 0) return;
							const opt = select.options[idx];
							const label = opt.text.trim();
							const value = opt.value || label;

							// If already selected (disabled), ignore
							if (opt.disabled) {
								select.selectedIndex = -1;
								return;
							}

							// Create chip and hidden input
							createChip(label, value, opt);

							// Prevent selecting the same option again
							opt.disabled = true;

							// Reset select selection
							select.selectedIndex = -1;
						}

						select.addEventListener('change', handleSelectChange);
					})();
				</script>
				

				<script is:inline>
					(function initIndicators() {
						const btn = document.getElementById('add-indicator-btn');
						const list = document.getElementById('indicators-list');

						if (!btn || !list) return;

						function makeRemoveIndicatorHandler(row) {
							return function handleRemoveIndicator() {
								row.remove();
							};
						}

						function createIndicatorRow(name = '', unit = '') {
							const row = document.createElement('div');
							row.className = 'flex gap-2 items-center';

							const inputName = document.createElement('input');
							inputName.type = 'text';
							inputName.name = 'indicator_names[]';
							inputName.placeholder = 'Indicador';
							inputName.value = name;
							inputName.className = 'flex-1 bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white';

							const inputUnit = document.createElement('input');
							inputUnit.type = 'text';
							inputUnit.name = 'indicator_units[]';
							inputUnit.placeholder = 'Unidad de medida';
							inputUnit.value = unit;
							inputUnit.className = 'w-52 bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white';

							const removeBtn = document.createElement('button');
							removeBtn.type = 'button';
							removeBtn.className = 'inline-flex items-center justify-center px-2 py-1 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg';
							removeBtn.textContent = 'Eliminar';
							removeBtn.addEventListener('click', makeRemoveIndicatorHandler(row));

							row.appendChild(inputName);
							row.appendChild(inputUnit);
							row.appendChild(removeBtn);

							return row;
						}

						function handleAddIndicator() {
							const row = createIndicatorRow();
							list.appendChild(row);
						}

						btn.addEventListener('click', handleAddIndicator);
					})();
				</script>
			</div>
			
		</div>
		
		<div
			class="p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800"
		>
			<div class="flow-root">
				<h3 class="text-xl font-semibold dark:text-white">Organizaciones responsables</h3>
				<ul class="mb-6 divide-y divide-gray-200 dark:divide-gray-700">
					<li class="py-4">
						<div
							class="flex justify-between xl:block 2xl:flex align-center 2xl:space-x-4"
						>
							<div class="flex space-x-4 xl:mb-4 2xl:mb-0">
								<div>
									<img
										class="w-6 h-6 rounded-full"
										src={asset('images/users/bonnie-green.png')}
										alt="Bonnie image"
									/>
								</div>
								<div class="flex-1 min-w-0">
									<p
										class="text-base font-semibold text-gray-900 leading-none truncate mb-0.5 dark:text-white"
									>
										Girls in Tech
									</p>
									<p
										class="mb-1 text-sm font-normal truncate text-primary-700 dark:text-primary-500"
									>
										Quito, Ecuador
									</p>
									<p
										class="text-xs font-medium text-gray-500 dark:text-gray-400"
									>
										Frecuencia de reporte: Mensual
									</p>
								</div>
							</div>
						</div>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<div class="col-span-2">
		<div
			class="p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800"
		>
			<h3 class="mb-4 text-xl font-semibold dark:text-white">
				Llenar indicadores del proyecto
			</h3>
			<form action="#">
				<div class="grid grid-cols-2 gap-6">
					<div class="col-span-6 sm:col-span-3">
						<label
							for="first-name"
							class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
							>

Porcentaje de permanencia Escolar (%)</label
						>
						<input
							type="text"
							name="first-name"
							id="first-name"
							class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
							placeholder="Ej: Porcentaje de permanencia Escolar "
							required
						/>
					</div>
					
					<div class="col-span-6 sm:col-span-3">
						<label
							for="first-name"
							class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
							>Profesores con capacitaciones puntuales (#) </label
						>
						<input
							type="text"
							name="first-name"
							id="first-name"
							class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
							placeholder="Ej: Porcentaje de permanencia Escolar "
							required
						/>
					</div>
					
					<div class="col-span-6 sm:col-span-3">
						<label
							for="first-name"
							class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
							>

Estudiantes con capacitaciones puntuales (#)</label
						>
						<input
							type="text"
							name="first-name"
							id="first-name"
							class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
							placeholder="Ej: 20%"
							required
						/>
					</div>
				
					
					<div class="mt-4 flex items-center justify-space-between">
						<div class="flex items-center gap-3">
					

							<button
								id="save-indicator-btn"
								type="button"
								class="inline-flex items-center px-3 py-2 text-sm font-medium text-white bg-primary-700 hover:bg-primary-800 rounded-lg focus:ring-4 focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700"
							>
								Guardar cambios
							</button>
						</div>
					</div>
					<div id="indicators-list" class="mt-3 space-y-2"></div>
				</div>
			</form>
		</div>
		<div
		class="p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800 xl:mb-0"
	>
	 <!-- Evidencias -->
		  <!-- Hitos -->
      <div class="space-y-3">
						<h3 class="text-xl font-semibold dark:text-white">Hitos del proyecto</h3>
        <div class="grid gap-3 sm:grid-cols-[150px_1fr_auto] items-end">
				
				
          <div>
            <label class="mb-1 block text-xs font-medium text-gray-400">Fecha del hito</label>
            <input id="hito-fecha" type="date" class="w-full rounded-lg border border-gray-700 bg-gray-900 px-3 py-2 text-sm text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-600"/>
          </div>
          <div>
            <label class="mb-1 block text-xs font-medium text-gray-400">Descripción</label>
            <input id="hito-desc" placeholder="Ej: Taller de navegación segura con 60 estudiantes"
                   class="w-full rounded-lg border border-gray-700 bg-gray-900 px-3 py-2 text-sm text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-600"/>
          </div>
          <button id="add-hito" type="button" class="rounded-lg bg-blue-600 px-3 py-2 text-sm font-medium text-white hover:bg-blue-500">
            Agregar hito
          </button>
        </div>

        <ul id="hitos-list" class="mt-2 space-y-2">
          <!-- items dinámicos -->
        </ul>
      </div>
      <div class="grid gap-3 sm:grid-cols-[1fr_auto] items-end">
        <div>
          <label class="mb-1 block text-xs font-medium text-gray-400">Evidencias (Google Drive)</label>
          <input name="evidencias" id="evidencias" type="url" placeholder="https://drive.google.com/..."
                 class="w-full rounded-lg border border-gray-700 bg-gray-900 px-3 py-2 text-sm text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-600"/>
        </div>
        <a id="open-drive" href="#" target="_blank" rel="noopener"
           class="inline-flex items-center justify-center rounded-lg bg-emerald-600 px-3 py-2 text-sm font-medium text-white hover:bg-emerald-500">
          Abrir Drive
        </a>
      </div>
	
	</div>
		
		
	</div>
</div>
<div class="grid grid-cols-1 px-4 xl:grid-cols-2 xl:gap-4">
	
	
</div>
